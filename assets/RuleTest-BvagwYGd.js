import{_ as j,u as A,g as D}from"./index-BxdBlEeC.js";import{u as M,c as h,r as _,o as N,w as I,e as c,f as s,t as u,h as l,F as L,l as R,n,j as f,b as d,q as z}from"./vendor-CvqS6pG7.js";const B={class:"rule-test-section my-4"},V={class:"text-secondary"},$={class:"row"},q={class:"card-body"},F={class:"jn-con-title card-title"},P={class:"card-text text-secondary",style:{"font-size":"10pt"}},G=["data-bs-theme"],H=["disabled"],J={key:0},K={key:1,class:"spinner-grow spinner-grow-sm bg-white","aria-hidden":"true"},O={__name:"RuleTest",setup(Q){const{t:e}=M(),v=A(),m=h(()=>v.isDarkMode),b=h(()=>v.isMobile),E=h(()=>v.lang),C=()=>({name:e("ruletest.Name"),ip:e("ruletest.StatusWait"),country_code:e("ruletest.StatusWait"),country:e("ruletest.StatusWait")}),r=_(Array.from({length:8},(o,a)=>({id:a+1,url:`ptest-${a+1}.ipcheck.ing`,...C()}))),y=_([]),g=_(r.value.length),p=_(!1),T=async(o,a)=>{try{const w=(await(await fetch(`https://${a}/cdn-cgi/trace`)).text()).split(`
`),W=w.find(i=>i.startsWith("ip=")),x=w.find(i=>i.startsWith("loc="));if(W){const i=W.split("=")[1];r.value[o].ip=i,y.value=[...y.value,i]}if(x){const i=x.split("=")[1];r.value[o].country_code=i,r.value[o].country=D(i,E.value)}}catch(t){r.value[o].ip=e("ruletest.StatusError"),r.value[o].country_code=e("ruletest.StatusError"),r.value[o].country=e("ruletest.StatusError"),console.error("Error fetching Data:",t)}},S=async(o=!1)=>{p.value=!1,o&&r.value.forEach(t=>{t.ip=e("ruletest.StatusWait"),t.country_code=e("ruletest.StatusWait")});const a=async t=>{if(t<g.value)try{await T(t,r.value[t].url)}catch(k){console.error("Error fetching Data:",k)}finally{a(t+1),t===g.value-1&&(p.value=!0)}};a(0)};return N(()=>{setTimeout(()=>{S()},1e3)}),I(y,()=>{v.updateAllIPs(y.value)},{deep:!0}),(o,a)=>(d(),c("div",null,[s("div",B,[s("div",V,[s("p",null,u(l(e)("ruletest.Note")),1)]),s("div",$,[(d(!0),c(L,null,R(r.value,t=>(d(),c("div",{key:t.id,class:"col-lg-3 col-md-6 col-12 mb-4"},[s("div",{class:n(["card jn-card",{"dark-mode dark-mode-border":m.value,"jn-hover-card":!b.value}])},[s("div",q,[s("p",F,[a[1]||(a[1]=s("i",{class:"bi bi-signpost-split-fill"},null,-1)),f(" "+u(t.name)+" ",1),s("i",{class:n(["bi","bi-"+t.id+"-square"])},null,2),a[2]||(a[2]=f("  "))]),s("p",P,[a[3]||(a[3]=s("i",{class:"bi bi-hdd-network-fill"},null,-1)),f(" "+u(t.url),1)]),s("p",{class:n(["card-text",{"text-info":t.ip===l(e)("ruletest.StatusWait"),"text-success":t.ip.includes(".")||t.ip.includes(":"),"text-danger":t.ip===l(e)("ruletest.StatusError")}])},[s("i",{class:n(["bi",[t.ip===l(e)("ruletest.StatusWait")?"bi-hourglass-split":"bi-pc-display-horizontal"]])}," ",2),s("span",{class:n({"jn-ip-font":t.ip.length>32})},u(t.ip),3)],2),s("div",{class:n(["alert",{"alert-info":t.country_code===l(e)("ruletest.StatusWait"),"alert-success":t.country_code!==l(e)("ruletest.StatusWait")}]),"data-bs-theme":m.value?"dark":""},[s("i",{class:n(["bi",[t.ip===l(e)("ruletest.StatusWait")||t.ip===l(e)("ruletest.StatusError")?"bi-hourglass-split":"bi-geo-alt-fill"]])},null,2),f(" "+u(l(e)("ruletest.Country"))+": ",1),s("strong",null,u(t.country)+" ",1),t.country_code!==l(e)("ruletest.StatusWait")?(d(),c("span",{key:0,class:n("jn-fl fi fi-"+t.country_code.toLowerCase())},null,2)):z("",!0)],10,G)])],2)]))),128)),s("div",{class:n(["flex justify-content-center col-12",[b.value?"":"text-center mt-4"]])},[s("button",{class:n(["btn",[p.value?"btn-success":"btn-info",b.value?"w-100":"w-25"]]),disabled:!p.value,onClick:a[0]||(a[0]=t=>S(!0))},[p.value?(d(),c("span",J,[a[4]||(a[4]=s("i",{class:"bi bi-arrow-clockwise"},null,-1)),f(" "+u(l(e)("ruletest.RefreshAll")),1)])):(d(),c("span",K))],10,H)],2)])])]))}},Y=j(O,[["__scopeId","data-v-a4ea68b8"]]);export{Y as default};
